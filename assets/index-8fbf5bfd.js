(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var we=Object.defineProperty,me=(t,e,s)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,o=(t,e,s)=>(me(t,typeof e!="symbol"?e+"":e,s),s);class ye{constructor(e,s){this.prefix=e,this.enabled=s}print(e,...s){if(!this.enabled)return;const n=new Date,r=Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(n);console[e](`[${r}]`,this.prefix,...s)}disable(){this.enabled=!1}error(...e){this.print("error",...e)}enable(){this.enabled=!0}log(...e){this.print("log",...e)}warn(...e){this.print("warn",...e)}}let ve="https://web.telegram.org";const L=new ye("[SDK]",!1);function Ee(){return ve}function te(){try{return window.self!==window.top}catch{return!0}}function j(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Ce(t){return"external"in t&&j(t.external)&&"notify"in t.external&&typeof t.external.notify=="function"}function xe(t){return"TelegramWebviewProxy"in t&&j(t.TelegramWebviewProxy)&&"postEvent"in t.TelegramWebviewProxy&&typeof t.TelegramWebviewProxy.postEvent=="function"}function f(t,e,s){let n={},r;e===void 0&&s===void 0?n={}:e!==void 0&&s!==void 0?(n=s,r=e):e!==void 0&&("targetOrigin"in e?n=e:r=e);const{targetOrigin:i=Ee()}=n;if(L.log(`Calling method "${t}"`,r),te()){window.parent.postMessage(JSON.stringify({eventType:t,eventData:r}),i);return}if(Ce(window)){window.external.notify(JSON.stringify({eventType:t,eventData:r}));return}if(xe(window)){window.TelegramWebviewProxy.postEvent(t,JSON.stringify(r));return}throw new Error("Unable to determine current environment and possible way to send event.")}function ke(t,e){const s=t.split("."),n=e.split("."),r=Math.max(s.length,n.length);for(let i=0;i<r;i+=1){const a=parseInt(s[i]||"0",10),c=parseInt(n[i]||"0",10);if(a!==c)return a>c?1:-1}return 0}function v(t,e){return ke(t,e)<=0}function A(t,e,s){if(typeof s=="string"){if(t==="web_app_open_link"&&e==="try_instant_view")return v("6.4",s);if(t==="web_app_set_header_color"&&e==="color")return v("6.9",s)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return v("6.1",e);case"web_app_open_popup":return v("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return v("6.4",e);case"web_app_switch_inline_query":return v("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return v("6.9",e);case"web_app_setup_settings_button":return v("6.10",e);default:return!0}}class M extends Error{constructor(e,s){super(`Method "${e}" is unsupported in the Mini Apps version ${s}.`),Object.setPrototypeOf(this,M.prototype)}}class z extends Error{constructor(e,s,n){super(`Parameter "${s}" in method "${e}" is unsupported in the Mini Apps version ${n}.`),Object.setPrototypeOf(this,z.prototype)}}function Pe(t){return(e,s)=>{if(!A(e,t))throw new M(e,t);if(j(s)){let n;if(e==="web_app_open_link"&&"try_instant_view"in s?n="try_instant_view":e==="web_app_set_header_color"&&"color"in s&&(n="color"),n&&!A(e,n,t))throw new z(e,n,t)}return f(e,s)}}function se(t){return({req_id:e})=>e===t}class N extends Error{constructor(e,{cause:s,type:n}={}){super(`Unable to parse value${n?` as ${n}`:""}`,{cause:s}),o(this,"type"),this.value=e,Object.setPrototypeOf(this,N.prototype),this.type=n}}class R extends Error{constructor(e,{cause:s,type:n}={}){super(`Unable to parse field "${e}"${n?` as ${n}`:""}`,{cause:s}),Object.setPrototypeOf(this,R.prototype)}}function ne(t,e){const s={};for(const n in t){const r=t[n];if(!r)continue;let i,a;if(typeof r=="function"||"parse"in r)i=n,a=typeof r=="function"?r:r.parse.bind(r);else{const{type:h}=r;i=r.from||n,a=typeof h=="function"?h:h.parse.bind(h)}let c;const u=e(i);try{c=a(u)}catch(h){throw h instanceof N?new R(i,{type:h.type,cause:h}):new R(i,{cause:h})}c!==void 0&&(s[n]=c)}return s}function O(){return new TypeError("Value has unexpected type")}function J(t){let e=t;if(typeof e=="string"&&(e=JSON.parse(e)),typeof e!="object"||e===null||Array.isArray(e))throw O();return e}class H{constructor(e,s,n){this.parser=e,this.isOptional=s,this.type=n}parse(e){if(!(this.isOptional&&e===void 0))try{return this.parser(e)}catch(s){throw new N(e,{type:this.type,cause:s})}}optional(){return this.isOptional=!0,this}}function g(t,e){return new H(s=>{const n=J(s);return ne(t,r=>n[r])},!1,e)}function S(t,e){return()=>new H(t,!1,e)}const p=S(t=>{if(typeof t=="string"||typeof t=="number")return t.toString();throw O()},"string");function qe(t){return g({eventType:p(),eventData:e=>e}).parse(t)}function Ae(t,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:t,eventData:e}),source:window.parent}))}function Oe(){const t=window;"TelegramGameProxy_receiveEvent"in t||[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(e=>{let s=t;e.forEach((n,r,i)=>{if(r===i.length-1){s[n]=Ae;return}n in s||(s[n]={}),s=s[n]})})}function Se(t){Oe(),window.addEventListener("message",e=>{if(e.source===window.parent)try{const{eventType:s,eventData:n}=qe(e.data);t(s,n)}catch{}})}function Ve(){return g({req_id:p(),data:t=>t===null?t:p().optional().parse(t)})}function Ie(){return g({req_id:p(),result:t=>t,error:p().optional()})}function Te(){return g({slug:p(),status:p()})}function De(){return g({status:p()})}function Le(){return g({button_id:t=>t==null?void 0:p().parse(t)})}function $e(){return g({data:p().optional()})}function F(t){return/^#[\da-f]{6}$/i.test(t)}function We(t){return/^#[\da-f]{3}$/i.test(t)}function re(t){const e=t.replace(/\s/g,"").toLowerCase();if(F(e))return e;if(We(e)){let n="#";for(let r=0;r<3;r+=1)n+=e[1+r].repeat(2);return n}const s=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(s===null)throw new Error(`Value "${t}" does not satisfy any of known RGB formats.`);return s.slice(1).reduce((n,r)=>{const i=parseInt(r,10).toString(16);return n+(i.length===1?"0":"")+i},"#")}const ie=S(t=>re(p().parse(t)),"rgb");function Re(){return g({theme_params:t=>{const e=ie().optional();return Object.entries(J(t)).reduce((s,[n,r])=>(s[n]=e.parse(r),s),{})}})}const E=S(t=>{if(typeof t=="boolean")return t;const e=String(t);if(e==="1"||e==="true")return!0;if(e==="0"||e==="false")return!1;throw O()},"boolean"),P=S(t=>{if(typeof t=="number")return t;if(typeof t=="string"){const e=Number(t);if(!Number.isNaN(e))return e}throw O()},"number");function Ne(){return g({height:P(),width:t=>t==null?window.innerWidth:P().parse(t),is_state_stable:E(),is_expanded:E()})}function He(){return g({status:p()})}class _{constructor(){o(this,"listeners",new Map),o(this,"subscribeListeners",[])}addListener(e,s,n){let r=this.listeners.get(e);return r||(r=[],this.listeners.set(e,r)),r.push([s,n]),()=>this.off(e,s)}emit(e,...s){this.subscribeListeners.forEach(r=>r(e,...s));const n=this.listeners.get(e);n&&n.forEach(([r,i],a)=>{r(...s),i&&n.splice(a,1)})}on(e,s){return this.addListener(e,s,!1)}once(e,s){return this.addListener(e,s,!0)}off(e,s){const n=this.listeners.get(e);if(n){for(let r=0;r<n.length;r+=1)if(s===n[r][0]){n.splice(r,1);return}}}subscribe(e){return this.subscribeListeners.push(e),()=>this.unsubscribe(e)}unsubscribe(e){for(let s=0;s<this.subscribeListeners.length;s+=1)if(this.subscribeListeners[s]===e){this.subscribeListeners.splice(s,1);return}}}function Be(){const t=new _,e=(s,...n)=>{L.log("Emitting processed event:",s,...n),t.emit(s,...n)};return window.addEventListener("resize",()=>{e("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})}),Se((s,n)=>{L.log("Received raw event:",s,n);try{switch(s){case"viewport_changed":return e(s,Ne().parse(n));case"theme_changed":return e(s,Re().parse(n));case"popup_closed":return n==null?e(s,{}):e(s,Le().parse(n));case"set_custom_style":return e(s,p().parse(n));case"qr_text_received":return e(s,$e().parse(n));case"clipboard_text_received":return e(s,Ve().parse(n));case"invoice_closed":return e(s,Te().parse(n));case"phone_requested":return e("phone_requested",De().parse(n));case"custom_method_invoked":return e("custom_method_invoked",Ie().parse(n));case"write_access_requested":return e("write_access_requested",He().parse(n));case"main_button_pressed":case"back_button_pressed":case"settings_button_pressed":case"scan_qr_popup_closed":case"reload_iframe":return e(s);default:return e(s,n)}}catch(r){L.error("Error processing event:",r)}}),t}const U="telegram-mini-apps-cached-emitter";function oe(){const t=window;return t[U]===void 0&&(t[U]=Be()),t[U]}function B(t,e){oe().off(t,e)}function k(t,e){return oe().on(t,e),()=>B(t,e)}class G extends Error{constructor(e){super(`Async call timeout exceeded. Timeout: ${e}`),Object.setPrototypeOf(this,G.prototype)}}function Ue(t){return new Promise((e,s)=>{setTimeout(s,t,new G(t))})}function ae(t,e){return Promise.race([typeof t=="function"?t():t,Ue(e)])}async function x(t,e,s){let n;const r=new Promise(w=>{n=w}),i=e?{...s,event:e,method:t}:t,{method:a,event:c,capture:u,postEvent:h=f,timeout:l}=i,b=(Array.isArray(c)?c:[c]).map(w=>k(w,d=>(!u||u(d))&&n(d)));try{return h(a,i.params),await(l?ae(r,l):r)}finally{b.forEach(w=>w())}}async function D(t,e,s,n={}){const{result:r,error:i}=await x("web_app_invoke_custom_method","custom_method_invoked",{...n,params:{method:t,params:e,req_id:s},capture:se(s)});if(i)throw new Error(i);return r}function ce(t){const e=re(t);return Math.sqrt([.299,.587,.114].reduce((s,n,r)=>{const i=parseInt(e.slice(1+r*2,1+(r+1)*2),16);return s+i*i*n},0))<120}class m{constructor(e,s){this.state=e,this.ee=s}internalSet(e,s){return this.state[e]===s||s===void 0?!1:(this.state[e]=s,this.ee.emit(`change:${e}`,s),!0)}clone(){return{...this.state}}set(e,s){let n=!1;if(typeof e=="string")n=this.internalSet(e,s);else for(const r in e)this.internalSet(r,e[r])&&(n=!0);n&&this.ee.emit("change")}get(e){return this.state[e]}}function y(t,e){return s=>A(e[s],t)}class je{constructor(e,s,n=f){o(this,"ee",new _),o(this,"state"),o(this,"on",(r,i)=>r==="click"?k("back_button_pressed",i):this.ee.on(r,i)),o(this,"off",(r,i)=>r==="click"?B("back_button_pressed",i):this.ee.off(r,i)),o(this,"supports"),this.postEvent=n,this.state=new m({isVisible:e},this.ee),this.supports=y(s,{show:"web_app_setup_back_button",hide:"web_app_setup_back_button"})}set isVisible(e){this.state.set("isVisible",e),this.postEvent("web_app_setup_back_button",{is_visible:e})}get isVisible(){return this.state.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}class Me{constructor(e,s=f){o(this,"ee",new _),o(this,"state"),o(this,"on",this.ee.on.bind(this.ee)),o(this,"off",this.ee.off.bind(this.ee)),this.postEvent=s,this.state=new m({isConfirmationNeeded:e},this.ee)}set isConfirmationNeeded(e){this.state.set("isConfirmationNeeded",e),this.postEvent("web_app_setup_closing_behavior",{need_confirmation:e})}get isConfirmationNeeded(){return this.state.get("isConfirmationNeeded")}disableConfirmation(){this.isConfirmationNeeded=!1}enableConfirmation(){this.isConfirmationNeeded=!0}}function ze(t){if(Array.isArray(t))return t;if(typeof t=="string")try{const e=JSON.parse(t);if(Array.isArray(e))return e}catch{}throw O()}class Je extends H{constructor(e,s,n){super(ze,s,n),o(this,"itemParser"),this.itemParser=typeof e=="function"?e:e.parse.bind(e)}parse(e){const s=super.parse(e);return s===void 0?s:s.map(this.itemParser)}of(e){return this.itemParser=typeof e=="function"?e:e.parse.bind(e),this}}function Fe(t){return new Je(e=>e,!1,t)}function Z(t,e){return t.reduce((s,n)=>(s[n]=e,s),{})}class Ge{constructor(e,s,n=f){o(this,"supports"),this.createRequestId=s,this.postEvent=n,this.supports=y(e,{delete:"web_app_invoke_custom_method",get:"web_app_invoke_custom_method",getKeys:"web_app_invoke_custom_method",set:"web_app_invoke_custom_method"})}async delete(e,s={}){const n=Array.isArray(e)?e:[e];n.length!==0&&await D("deleteStorageValues",{keys:n},this.createRequestId(),{...s,postEvent:this.postEvent})}async getKeys(e={}){const s=await D("getStorageKeys",{},this.createRequestId(),{...e,postEvent:this.postEvent});return Fe().of(p()).parse(s)}async get(e,s={}){const n=Array.isArray(e)?e:[e];if(n.length===0)return Z(n,"");const r=g(Z(n,p())),i=await D("getStorageValues",{keys:n},this.createRequestId(),{...s,postEvent:this.postEvent}).then(a=>r.parse(a));return Array.isArray(e)?i:i[e]}async set(e,s,n={}){await D("saveStorageValue",{key:e,value:s},this.createRequestId(),{...n,postEvent:this.postEvent})}}class Ke{constructor(e,s=f){o(this,"supports"),this.postEvent=s,this.supports=y(e,{impactOccurred:"web_app_trigger_haptic_feedback",notificationOccurred:"web_app_trigger_haptic_feedback",selectionChanged:"web_app_trigger_haptic_feedback"})}impactOccurred(e){this.postEvent("web_app_trigger_haptic_feedback",{type:"impact",impact_style:e})}notificationOccurred(e){this.postEvent("web_app_trigger_haptic_feedback",{type:"notification",notification_type:e})}selectionChanged(){this.postEvent("web_app_trigger_haptic_feedback",{type:"selection_change"})}}function Qe(){return g({id:P(),type:p(),title:p(),photoUrl:{type:p().optional(),from:"photo_url"},username:p().optional()},"Chat")}class Ze{constructor(e){this.initData=e}get authDate(){return this.initData.authDate}get canSendAfter(){return this.initData.canSendAfter}get canSendAfterDate(){const{canSendAfter:e}=this;return e===void 0?void 0:new Date(this.authDate.getTime()+e*1e3)}get chat(){return this.initData.chat}get chatType(){return this.initData.chatType}get chatInstance(){return this.initData.chatInstance}get hash(){return this.initData.hash}get queryId(){return this.initData.queryId}get receiver(){return this.initData.receiver}get startParam(){return this.initData.startParam}get user(){return this.initData.user}}function X(){return g({addedToAttachmentMenu:{type:E().optional(),from:"added_to_attachment_menu"},allowsWriteToPm:{type:E().optional(),from:"allows_write_to_pm"},firstName:{type:p(),from:"first_name"},id:P(),isBot:{type:E().optional(),from:"is_bot"},isPremium:{type:E().optional(),from:"is_premium"},languageCode:{type:p().optional(),from:"language_code"},lastName:{type:p().optional(),from:"last_name"},photoUrl:{type:p().optional(),from:"photo_url"},username:p().optional()},"User")}const pe=S(t=>t instanceof Date?t:new Date(P().parse(t)*1e3),"Date");function K(t,e){return new H(s=>{if(typeof s!="string"&&!(s instanceof URLSearchParams))throw O();const n=typeof s=="string"?new URLSearchParams(s):s;return ne(t,r=>{const i=n.get(r);return i===null?void 0:i})},!1,e)}function Xe(){return K({authDate:{type:pe(),from:"auth_date"},canSendAfter:{type:P().optional(),from:"can_send_after"},chat:Qe().optional(),chatInstance:{type:p().optional(),from:"chat_instance"},chatType:{type:p().optional(),from:"chat_type"},hash:p(),queryId:{type:p().optional(),from:"query_id"},receiver:X().optional(),startParam:{type:p().optional(),from:"start_param"},user:X().optional()},"InitData")}function Ye(t){const{hostname:e,pathname:s}=new URL(t,window.location.href);if(e!=="t.me")throw new Error(`Incorrect hostname: ${e}`);const n=s.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(n===null)throw new Error('Link pathname has incorrect format. Expected to receive "/invoice/{slug}" or "/${slug}"');return n[2]}class et{constructor(e,s=f){o(this,"ee",new _),o(this,"state"),o(this,"on",this.ee.on.bind(this.ee)),o(this,"off",this.ee.off.bind(this.ee)),o(this,"supports"),this.postEvent=s,this.state=new m({isOpened:!1},this.ee),this.supports=y(e,{open:"web_app_open_invoice"})}set isOpened(e){this.state.set("isOpened",e)}get isOpened(){return this.state.get("isOpened")}async open(e,s){if(this.isOpened)throw new Error("Invoice is already opened");const n=s?Ye(e):e;this.isOpened=!0;try{return(await x("web_app_open_invoice","invoice_closed",{params:{slug:n},postEvent:this.postEvent,capture(r){return n===r.slug}})).status}finally{this.isOpened=!1}}}class tt{constructor(e){o(this,"ee",new _),o(this,"state"),o(this,"postEvent"),o(this,"on",(h,l)=>h==="click"?k("main_button_pressed",l):this.ee.on(h,l)),o(this,"off",(h,l)=>h==="click"?B("main_button_pressed",l):this.ee.off(h,l));const{postEvent:s=f,text:n,textColor:r,backgroundColor:i,isEnabled:a,isVisible:c,isLoaderVisible:u}=e;this.postEvent=s,this.state=new m({backgroundColor:i,isEnabled:a,isVisible:c,isLoaderVisible:u,text:n,textColor:r},this.ee)}commit(){this.text!==""&&this.postEvent("web_app_setup_main_button",{is_visible:this.isVisible,is_active:this.isEnabled,is_progress_visible:this.isLoaderVisible,text:this.text,color:this.backgroundColor,text_color:this.textColor})}set isEnabled(e){this.setParams({isEnabled:e})}get isEnabled(){return this.state.get("isEnabled")}set isLoaderVisible(e){this.setParams({isLoaderVisible:e})}get isLoaderVisible(){return this.state.get("isLoaderVisible")}set isVisible(e){this.setParams({isVisible:e})}get isVisible(){return this.state.get("isVisible")}get backgroundColor(){return this.state.get("backgroundColor")}get text(){return this.state.get("text")}get textColor(){return this.state.get("textColor")}disable(){return this.isEnabled=!1,this}enable(){return this.isEnabled=!0,this}hide(){return this.isVisible=!1,this}hideLoader(){return this.isLoaderVisible=!1,this}show(){return this.isVisible=!0,this}showLoader(){return this.isLoaderVisible=!0,this}setText(e){return this.setParams({text:e})}setTextColor(e){return this.setParams({textColor:e})}setBackgroundColor(e){return this.setParams({backgroundColor:e})}setParams(e){return this.state.set(e),this.commit(),this}}const st=K({contact:g({userId:{type:P(),from:"user_id"},phoneNumber:{type:p(),from:"phone_number"},firstName:{type:p(),from:"first_name"},lastName:{type:p().optional(),from:"last_name"}}),authDate:{type:pe(),from:"auth_date"},hash:p()});function ue(t,e){return s=>{const[n,r]=e[s];return A(n,r,t)}}function nt(t){return new Promise(e=>{setTimeout(e,t)})}class rt{constructor(e){o(this,"ee",new _),o(this,"state"),o(this,"botInline"),o(this,"postEvent"),o(this,"createRequestId"),o(this,"requestingPhoneAccess",!1),o(this,"requestingWriteAccess",!1),o(this,"on",this.ee.on.bind(this.ee)),o(this,"off",this.ee.off.bind(this.ee)),o(this,"supports"),o(this,"supportsParam");const{postEvent:s=f,headerColor:n,backgroundColor:r,version:i,botInline:a,createRequestId:c}=e,u=y(i,{requestPhoneAccess:"web_app_request_phone",requestWriteAccess:"web_app_request_write_access",switchInlineQuery:"web_app_switch_inline_query",setHeaderColor:"web_app_set_header_color",setBackgroundColor:"web_app_set_background_color"});this.postEvent=s,this.botInline=a,this.createRequestId=c,this.supports=h=>!(!u(h)||h==="switchInlineQuery"&&!a),this.state=new m({backgroundColor:r,headerColor:n},this.ee),this.supportsParam=ue(i,{"setHeaderColor.color":["web_app_set_header_color","color"]})}async getRequestedContact(){return D("getRequestedContact",{},this.createRequestId(),{postEvent:this.postEvent,timeout:1e4}).then(e=>st.parse(e))}get backgroundColor(){return this.state.get("backgroundColor")}close(){this.postEvent("web_app_close")}get headerColor(){return this.state.get("headerColor")}get isBotInline(){return this.botInline}get isDark(){return ce(this.backgroundColor)}get isRequestingPhoneAccess(){return this.requestingPhoneAccess}get isRequestingWriteAccess(){return this.requestingWriteAccess}ready(){this.postEvent("web_app_ready")}async requestContact({timeout:e=5e3}={}){try{return await this.getRequestedContact()}catch{}if(await this.requestPhoneAccess()!=="sent")throw new Error("Access denied.");const s=Date.now()+e;let n=50;return ae(async()=>{for(;Date.now()<s;){try{return await this.getRequestedContact()}catch{}await nt(n),n+=50}throw new Error("Unable to retrieve requested contact.")},e)}requestPhoneAccess(e={}){if(this.requestingPhoneAccess)throw new Error("Phone access is already being requested.");return this.requestingPhoneAccess=!0,x("web_app_request_phone","phone_requested",{...e,postEvent:this.postEvent}).then(s=>s.status).finally(()=>{this.requestingPhoneAccess=!1})}requestWriteAccess(e={}){if(this.requestingWriteAccess)throw new Error("Write access is already being requested.");return this.requestingWriteAccess=!0,x("web_app_request_write_access","write_access_requested",{...e,postEvent:this.postEvent}).then(s=>s.status).finally(()=>{this.requestingWriteAccess=!1})}sendData(e){const{size:s}=new Blob([e]);if(s===0||s>4096)throw new Error(`Passed data has incorrect size: ${s}`);this.postEvent("web_app_data_send",{data:e})}setHeaderColor(e){this.postEvent("web_app_set_header_color",F(e)?{color:e}:{color_key:e}),this.state.set("headerColor",e)}setBackgroundColor(e){this.postEvent("web_app_set_background_color",{color:e}),this.state.set("backgroundColor",e)}switchInlineQuery(e,s=[]){if(!this.supports("switchInlineQuery")&&!this.isBotInline)throw new Error("Method is unsupported because Mini App should be launched in inline mode.");this.postEvent("web_app_switch_inline_query",{query:e,chat_types:s})}}function it(t){const e=t.message.trim(),s=(t.title||"").trim(),n=t.buttons||[];let r;if(s.length>64)throw new Error(`Title has incorrect size: ${s.length}`);if(e.length===0||e.length>256)throw new Error(`Message has incorrect size: ${e.length}`);if(n.length>3)throw new Error(`Buttons have incorrect size: ${n.length}`);return n.length===0?r=[{type:"close",id:""}]:r=n.map(i=>{const{id:a=""}=i;if(a.length>64)throw new Error(`Button ID has incorrect size: ${a}`);if(i.type===void 0||i.type==="default"||i.type==="destructive"){const c=i.text.trim();if(c.length===0||c.length>64){const u=i.type||"default";throw new Error(`Button text with type "${u}" has incorrect size: ${i.text.length}`)}return{...i,text:c,id:a}}return{...i,id:a}}),{title:s,message:e,buttons:r}}class ot{constructor(e,s=f){o(this,"ee",new _),o(this,"state"),o(this,"on",this.ee.on.bind(this.ee)),o(this,"off",this.ee.off.bind(this.ee)),o(this,"supports"),this.postEvent=s,this.state=new m({isOpened:!1},this.ee),this.supports=y(e,{open:"web_app_open_popup"})}set isOpened(e){this.state.set("isOpened",e)}get isOpened(){return this.state.get("isOpened")}open(e){if(this.isOpened)throw new Error("Popup is already opened.");return this.isOpened=!0,x("web_app_open_popup","popup_closed",{postEvent:this.postEvent,params:it(e)}).then(({button_id:s=null})=>s).finally(()=>{this.isOpened=!1})}}class at{constructor(e,s=f){o(this,"ee",new _),o(this,"state"),o(this,"on",this.ee.on.bind(this.ee)),o(this,"off",this.ee.off.bind(this.ee)),o(this,"supports"),this.postEvent=s,this.state=new m({isOpened:!1},this.ee),this.supports=y(e,{close:"web_app_close_scan_qr_popup",open:"web_app_open_scan_qr_popup"})}close(){this.postEvent("web_app_close_scan_qr_popup"),this.isOpened=!1}set isOpened(e){this.state.set("isOpened",e)}get isOpened(){return this.state.get("isOpened")}async open(e){if(this.isOpened)throw new Error("QR scanner is already opened.");this.isOpened=!0;try{const s=await x("web_app_open_scan_qr_popup",["qr_text_received","scan_qr_popup_closed"],{postEvent:this.postEvent,params:{text:e}});return typeof s=="object"&&typeof s.data=="string"?s.data:null}finally{this.isOpened=!1}}}class ct{constructor(e,s,n=f){o(this,"ee",new _),o(this,"state"),o(this,"on",(r,i)=>r==="click"?k("settings_button_pressed",i):this.ee.on(r,i)),o(this,"off",(r,i)=>r==="click"?B("settings_button_pressed",i):this.ee.off(r,i)),o(this,"supports"),this.postEvent=n,this.state=new m({isVisible:e},this.ee),this.supports=y(s,{show:"web_app_setup_settings_button",hide:"web_app_setup_settings_button"})}set isVisible(e){this.state.set("isVisible",e),this.postEvent("web_app_setup_settings_button",{is_visible:e})}get isVisible(){return this.state.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}function pt(t){return t.replace(/(^|_)bg/,(e,s)=>`${s}background`).replace(/_([a-z])/g,(e,s)=>s.toUpperCase())}function ut(t){return t.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`).replace(/(^|_)background/,(e,s)=>`${s}bg`)}const he=S(t=>{const e=ie().optional();return Object.entries(J(t)).reduce((s,[n,r])=>(s[pt(n)]=e.parse(r),s),{})},"ThemeParams");function ht(t){return he().parse(t)}function lt(t){return JSON.stringify(Object.entries(t).reduce((e,[s,n])=>(n&&(e[ut(s)]=n),e),{}))}class dt{constructor(e){o(this,"ee",new _),o(this,"state"),o(this,"on",this.ee.on.bind(this.ee)),o(this,"off",this.ee.off.bind(this.ee)),this.state=new m(e,this.ee)}get accentTextColor(){return this.get("accentTextColor")}get backgroundColor(){return this.get("backgroundColor")}get buttonColor(){return this.get("buttonColor")}get buttonTextColor(){return this.get("buttonTextColor")}get destructiveTextColor(){return this.get("destructiveTextColor")}get(e){return this.state.get(e)}getState(){return this.state.clone()}get headerBackgroundColor(){return this.get("headerBackgroundColor")}get hintColor(){return this.get("hintColor")}get isDark(){return!this.backgroundColor||ce(this.backgroundColor)}get linkColor(){return this.get("linkColor")}get secondaryBackgroundColor(){return this.get("secondaryBackgroundColor")}get sectionBackgroundColor(){return this.get("sectionBackgroundColor")}get sectionHeaderTextColor(){return this.get("sectionHeaderTextColor")}listen(){return k("theme_changed",e=>{this.state.set(ht(e.theme_params))})}get subtitleTextColor(){return this.get("subtitleTextColor")}get textColor(){return this.get("textColor")}}class ft{constructor(e,s,n=f){o(this,"supports"),o(this,"supportsParam"),this.version=e,this.createRequestId=s,this.postEvent=n,this.supports=y(e,{readTextFromClipboard:"web_app_read_text_from_clipboard"}),this.supportsParam=ue(e,{"openLink.tryInstantView":["web_app_open_link","try_instant_view"]})}openLink(e,s){const n=new URL(e,window.location.href).toString();if(!A("web_app_open_link",this.version)){window.open(n,"_blank");return}this.postEvent("web_app_open_link",{url:n,...typeof s=="boolean"?{try_instant_view:s}:{}})}openTelegramLink(e){const{hostname:s,pathname:n,search:r}=new URL(e,window.location.href);if(s!=="t.me")throw new Error(`URL has not allowed hostname: ${s}. Only "t.me" is allowed`);if(!A("web_app_open_tg_link",this.version)){window.location.href=e;return}this.postEvent("web_app_open_tg_link",{path_full:n+r})}async readTextFromClipboard(){const e=this.createRequestId(),{data:s=null}=await x("web_app_read_text_from_clipboard","clipboard_text_received",{postEvent:this.postEvent,params:{req_id:e},capture:se(e)});return s}}function gt(t){return["macos","tdesktop","unigram","web","weba"].includes(t)}async function le(t){const e=await x("web_app_request_viewport","viewport_changed",t);return{height:e.height,width:e.width,isExpanded:e.is_expanded,isStateStable:e.is_state_stable}}function T(t){return t<0?0:t}class _t{constructor(e){o(this,"ee",new _),o(this,"state"),o(this,"postEvent"),o(this,"on",this.ee.on.bind(this.ee)),o(this,"off",this.ee.off.bind(this.ee));const{height:s,isExpanded:n,width:r,stableHeight:i,postEvent:a=f}=e;this.postEvent=a,this.state=new m({height:T(s),isExpanded:n,stableHeight:T(i),width:T(r)},this.ee)}sync(e){return le(e).then(({height:s,isExpanded:n,width:r,isStateStable:i})=>{this.state.set({height:s,width:r,isExpanded:n,stableHeight:i?s:this.state.get("stableHeight")})})}get height(){return this.state.get("height")}get stableHeight(){return this.state.get("stableHeight")}listen(){return k("viewport_changed",e=>{const{height:s,width:n,is_expanded:r,is_state_stable:i}=e,a={height:T(s),isExpanded:r,width:T(n)};i&&(a.stableHeight=a.height),this.state.set(a)})}get isExpanded(){return this.state.get("isExpanded")}get width(){return this.state.get("width")}expand(){this.postEvent("web_app_expand"),this.state.set("isExpanded",!0)}get isStable(){return this.stableHeight===this.height}}function C(t,e){document.documentElement.style.setProperty(t,e)}function bt(t,e){const s=()=>{C("--tg-background-color",t.backgroundColor)},n=()=>{const{backgroundColor:r,secondaryBackgroundColor:i}=e;if(F(t.headerColor)){C("--tg-header-color",t.headerColor);return}if(t.headerColor==="bg_color"&&r){C("--tg-header-color",r);return}t.headerColor==="secondary_bg_color"&&i&&C("--tg-header-color",i)};e.on("change",n),t.on("change:backgroundColor",s),t.on("change:headerColor",n),s(),n()}function wt(t){const e=()=>{const s=t.getState();Object.entries(s).forEach(([n,r])=>{if(r){const i=n.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`);C(`--tg-theme-${i}`,r)}})};t.on("change",e),e()}function Y(t){const e=()=>C("--tg-viewport-height",`${t.height}px`),s=()=>C("--tg-viewport-width",`${t.width}px`),n=()=>C("--tg-viewport-stable-height",`${t.stableHeight}px`);t.on("change:height",e),t.on("change:width",s),t.on("change:stableHeight",n),e(),s(),n()}function mt(){const t=document.createElement("style");t.id="telegram-custom-styles",document.head.appendChild(t),k("set_custom_style",e=>{t.innerHTML=e})}function de(t){return`telegram-mini-apps-${t}`}function V(t,e){sessionStorage.setItem(de(t),JSON.stringify(e))}function I(t){const e=sessionStorage.getItem(de(t));return e?JSON.parse(e):null}function yt(t,e,s){const{isVisible:n=!1}=t?I("back-button")||{}:{},r=new je(n,e,s);return r.on("change",()=>{V("back-button",{isVisible:r.isVisible})}),r}function vt(t,e){const{isConfirmationNeeded:s=!1}=t?I("closing-behavior")||{}:{},n=new Me(s,e);return n.on("change",()=>V("closing-behavior",{isConfirmationNeeded:n.isConfirmationNeeded})),n}function Et(t,e,s,n){const{backgroundColor:r=e,isEnabled:i=!1,isVisible:a=!1,isLoaderVisible:c=!1,textColor:u=s,text:h=""}=t?I("main-button")||{}:{},l=new tt({backgroundColor:r,isEnabled:i,isLoaderVisible:c,isVisible:a,postEvent:n,text:h,textColor:u}),b=()=>V("main-button",{backgroundColor:l.backgroundColor,isEnabled:l.isEnabled,isLoaderVisible:l.isLoaderVisible,isVisible:l.isVisible,text:l.text,textColor:l.textColor});return l.on("change",b),l}function Ct(t,e,s,n,r,i){const{backgroundColor:a=e,headerColor:c="bg_color"}=t?I("mini-app")||{}:{},u=new rt({headerColor:c,backgroundColor:a,version:s,botInline:n,createRequestId:r,postEvent:i}),h=()=>V("mini-app",{backgroundColor:u.backgroundColor,headerColor:u.headerColor});return u.on("change",h),u}function xt(){let t=0;return()=>(t+=1,t.toString())}function kt(t,e,s){const{isVisible:n=!1}=t?I("settings-button")||{}:{},r=new ct(n,e,s);return r.on("change",()=>{V("settings-button",{isVisible:r.isVisible})}),r}function Pt(t){const e=new dt(t);return e.listen(),e}function W(t){const e=new _t(t);return e.on("change",()=>V("viewport",{height:e.height,isExpanded:e.isExpanded,stableHeight:e.stableHeight,width:e.width})),e.listen(),e}function qt(t,e,s,n){const r=t?I("viewport"):null;if(r)return W({...r,postEvent:s});if(gt(e))return W({height:window.innerHeight,isExpanded:!0,postEvent:s,stableHeight:window.innerHeight,width:window.innerWidth});if(n)return le({postEvent:s,timeout:5e3}).then(({height:a,isStateStable:c,...u})=>W({...u,height:a,stableHeight:c?a:0}));const i=W({width:0,height:0,isExpanded:!1,postEvent:s,stableHeight:0});return i.sync({postEvent:s,timeout:5e3}).catch(a=>{console.error("Unable to actualize viewport state",a)}),i}function At(t){return typeof t=="object"?t:t?{themeParams:!0,viewport:!0,miniApp:!0}:{}}function ee(t,e,s,n){const r=At(t);r.miniApp&&bt(e,s),r.themeParams&&wt(s),r.viewport&&(n instanceof Promise?n.then(Y):Y(n))}function Ot(){return K({botInline:{type:E().optional(),from:"tgWebAppBotInline"},initData:{type:Xe().optional(),from:"tgWebAppData"},initDataRaw:{type:p().optional(),from:"tgWebAppData"},platform:{type:p(),from:"tgWebAppPlatform"},showSettings:{type:E().optional(),from:"tgWebAppShowSettings"},startParam:{type:p().optional(),from:"tgWebAppStartParam"},themeParams:{type:he(),from:"tgWebAppThemeParams"},version:{type:p(),from:"tgWebAppVersion"}},"LaunchParams")}function fe(t){return Ot().parse(t)}function ge(t){return fe(t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function St(){return ge(window.location.href)}function _e(){return performance.getEntriesByType("navigation")[0]}function Vt(){const t=_e();if(!t)throw new Error("Unable to get first navigation entry.");return ge(t.name)}function It(t){const{initDataRaw:e,themeParams:s,platform:n,version:r,showSettings:i,startParam:a,botInline:c}=t,u=new URLSearchParams;return e&&u.set("tgWebAppData",e),u.set("tgWebAppPlatform",n),u.set("tgWebAppThemeParams",lt(s)),u.set("tgWebAppVersion",r),a&&u.set("tgWebAppStartParam",a),typeof i=="boolean"&&u.set("tgWebAppShowSettings",i?"1":"0"),typeof c=="boolean"&&u.set("tgWebAppBotInline",c?"1":"0"),u.toString()}const be="telegram-mini-apps-launch-params";function Tt(){return fe(sessionStorage.getItem(be)||"")}function Dt(t){sessionStorage.setItem(be,It(t))}function Lt(){const t=[];for(const e of[St,Vt,Tt])try{const s=e();return Dt(s),s}catch(s){t.push(s)}throw L.error("Unable to extract launch parameters. Received errors:",t),new Error("Unable to retrieve launch parameters from any known source.")}function $t(){var t;return((t=_e())==null?void 0:t.type)==="reload"}function Wt(t={}){const{async:e=!1,complete:s=e,cssVars:n=!1,acceptCustomStyles:r=!1}=t;try{const{initData:i,initDataRaw:a,version:c,platform:u,themeParams:h,botInline:l=!1}=Lt(),b=$t(),w=xt(),d=Pe(c);te()&&(r&&mt(),d("iframe_ready",{reload_supported:!0}),k("reload_iframe",()=>{d("iframe_will_reload"),window.location.reload()}));const q={backButton:yt(b,c,d),closingBehavior:vt(b,d),cloudStorage:new Ge(c,w,d),createRequestId:w,hapticFeedback:new Ke(c,d),invoice:new et(c,d),mainButton:Et(b,h.buttonColor||"#000000",h.buttonTextColor||"#ffffff",d),miniApp:Ct(b,h.backgroundColor||"#ffffff",c,l,w,d),popup:new ot(c,d),postEvent:d,qrScanner:new at(c,d),settingsButton:kt(b,c,d),themeParams:Pt(h),utils:new ft(c,w,d),...i?{initData:new Ze(i),initDataRaw:a}:{}},$=qt(b,u,d,s);return $ instanceof Promise||s?Promise.resolve($).then(Q=>(ee(n,q.miniApp,q.themeParams,Q),{...q,viewport:Q})):(ee(n,q.miniApp,q.themeParams,$),{...q,viewport:$})}catch(i){if(s)return Promise.reject(i);throw i}}function Rt({mainButton:t,backButton:e}){let s=0;const n=r=>{s=r,s===0?e.hide():e.show(),t.setText(`Counter: ${s}`)};e.on("click",()=>n(s-1)),t.on("click",()=>n(s+1)),t.setText("Click me").enable().show()}function Nt(t){const e=document.createElement("div");e.innerText=t instanceof Error?t.message:JSON.stringify(t),document.body.appendChild(e)}Wt({async:!0,cssVars:!0,acceptCustomStyles:!0}).then(Rt).catch(Nt);
